# VPS 剩余价值计算器 v2

[![许可证: RPL-1.5](https://img.shields.io/badge/License-RPL--1.5-brightgreen.svg)](https://opensource.org/licenses/RPL-1.5)
[![技术栈](https://img.shields.io/badge/tech-Vanilla_JS-yellow.svg)](#-技术栈)
[![状态](https://img.shields.io/badge/status-stable-green.svg)](#)

> 一款极简、专业、可分享的 VPS（或其它订阅制服务）剩余价值计算工具。

它能帮助用户在交易二手服务时，快速、精确地评估其剩余价值和溢价情况。

![项目截图](https://raw.githubusercontent.com/Tomzhao1016/vps_surplus_value/main/screenshot.png)

---

## ✨ 功能特性

本项目完全由纯前端技术实现，在 **简洁的界面** 之下，包含了对 **用户体验、健壮性和专业性** 的深度思考。

### 核心计算

- **✔️ 精确估值**：根据续费价格、周期、汇率、到期日和交易日，科学计算服务剩余价值。
- **✔️ 溢价分析**：根据用户出价，自动计算与剩余价值的差额（溢价或折价）。
- **✔️ 实时汇率**：自动从自有 API 获取主流货币对人民币 (CNY) 的汇率，同时支持用户手动覆盖。
- **✔️ 多周期支持**：内置月、季、半年、年、两年、三年等多种常见续费周期。

### 体验与设计

- **🎨 响应式布局**：完美适配桌面和移动设备，提供一致的访问体验。
- **🌗 双主题模式**：支持浅色 / 暗黑主题，并能自动适配操作系统偏好，实现无缝切换。
- **💬 动态通知**：通过 Toast 通知为用户的操作（如计算、复制、清空）提供即时、清晰的反馈。
- **🔗 分享与导出**：一键生成包含所有参数的分享链接，方便他人打开链接即可复现计算场景。

### 健壮性与可访问性

- **🛡️ 输入安全**：前端实时校验输入内容，防止负数、超大数值或非法字符导致计算错误或程序崩溃。
- **🔗 链接安全**：安全解析 URL 参数，能抵御因畸形参数导致的脚本执行中断。
- **💪 依赖降级**：当日期选择器库 (`flatpickr`) 加载失败时，会自动降级为浏览器原生日期控件，保证核心功能可用。
- **♿ 无障碍访问 (A11y)**：为弹窗提供完整的键盘焦点管理 (Focus Trap)，确保键盘流用户的无障碍使用。

---

## 🚀 如何运行

本项目为纯静态前端项目，无需任何构建步骤，上手极其简单。

1. **克隆仓库**
   ```bash
   git clone https://github.com/Tomzhao1016/vps_surplus_value.git
   ```

2. **启动**
   - **方式一 (推荐)**：使用一个简单的本地服务器来运行，以确保所有功能（特别是 API 请求）正常工作。
     ```bash
     # 如果你安装了 Node.js，可以使用 serve
     npm install -g serve
     serve .
     ```
   - **方式二**：直接在现代浏览器中打开 `index.html` 文件。

---

## 🛠️ 技术栈

- **JavaScript (Vanilla JS)**：无任何前端框架，使用原生 JS 编写核心逻辑。
- **HTML5**：语义化标签结构。
- **CSS3**：使用现代 CSS 特性（如变量、Grid 布局）构建界面和主题。
- **[Flatpickr.js](https://flatpickr.js.org/)**：轻量、强大的日期选择器库。
- **[Font Awesome](https://fontawesome.com/)**：提供高质量的图标。

---

## 🔬 核心算法

本工具的计算逻辑公开透明，遵循以下步骤：

1. **周期价格 (RMB)**  
   公式：`周期价格 = 续费金额(外币) × 汇率`

2. **折合年付价格 (RMB)**  
   公式：`年付价格 = 周期价格 × (12 ÷ 周期月数)`

3. **每日价值 (RMB)**  
   公式：`每日价值 = 年付价格 ÷ 365`

4. **剩余价值 (RMB)**  
   公式：`剩余价值 = 每日价值 × 剩余天数`

5. **溢价 / 差额 (RMB)**  
   公式：`溢价 = 出价金额 - 剩余价值`

> **注**：`剩余天数 = 到期日期 - 交易日期`，结果向下取整。

---

## 📡 API 说明

本项目的汇率数据通过自建的 API 代理服务获取，以避免客户端直接请求第三方 API 时遇到的跨域和密钥暴露问题。

- **API Endpoint**：`https://api.iloli.im/exchange_rate/v2/index.php/latest/{CURRENCY_CODE}`  
- **示例**：`.../latest/USD`  
- **速率限制**：单个 IP 在 10 秒内请求不超过 10 次。

---

## 🤝 贡献

欢迎通过提交 **Pull Request** 或创建 **Issue** 的方式为本项目做出贡献！

---

## 📄 许可证 (License)

本项目采用 **Reciprocal Public License 1.5 (RPL-1.5)** 许可证。  
这是一个独特的开源许可证，旨在促进源代码的共享与改进。

### RPL-1.5 的主要特点

- **源代码可用性**：使用本软件的任何人都必须使其源代码可用。
- **改进共享**：对软件的任何改进或修改都必须在相同的许可证下共享。
- **商业使用**：允许商业使用，但有特定条件。
- **专利授权**：包含明确的专利授权条款。
- **归属要求**：要求在使用或分发软件时提供适当的归属。

### 使用本项目时的注意事项

- 如果您修改了本项目的代码，必须公开发布修改内容，并使用相同的 **RPL-1.5** 许可证。
- 如果您在项目中使用了本软件，可能需要公开您 **整个项目** 的源代码。
- 商业使用是允许的，但请仔细阅读许可证以了解具体要求。

> **重要提示**：  
> 在使用、修改或分发本软件之前，请仔细阅读完整的 **RPL-1.5** 许可证文本。  
> 您可以在项目根目录的 `LICENSE` 文件中找到完整的许可证内容。  
> 若对如何遵守该许可证有疑问，建议咨询法律专业人士。
